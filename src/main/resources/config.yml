# AntiCheatLite configuration (Paper 1.16.5)

bypass_permission: anticheatlite.bypass

alerts:
  enabled: true
  format: "&c[AC]&7 {player} &f{check} &7VL={vl} &8({details})"

punishments:
  # Action when total VL exceeds threshold.
  # Options: NONE, SETBACK, KICK
  action: SETBACK
  threshold_vl: 6.0

  # "Annoy mode" starts only after player's TOTAL VL reaches this value.
  # Affects punish-style actions like annoy damage / scaffold block-break / blink damage.
  # <= 0 means always annoy (old behavior).
  annoy_mode_threshold_vl: 8.0

  # If true: on ANY flag (any check) we will immediately SETBACK (teleport back)
  # to annoy blatant cheats. This does NOT kick; kick still uses threshold.
  setback_on_flag: true

checks:
  speed:
    enabled: true
    # Vanilla refs:
    # - walk ~4.317 bps, sprint ~5.612 bps (~+30%)
    # - Speed effect: +20% movement speed per level
    base_walk_bps: 4.32
    sprint_multiplier: 1.30
    # Sprint-jump spikes are common (esp. with tick jitter); allow extra headroom while airborne.
    air_bonus_bps: 2.4
    speed_potion_multiplier_per_level: 0.20
    sample_window_ms: 450
    min_samples: 3
    min_move_ms: 35
    max_move_ms: 220
    # Slightly looser to reduce lag/sprint-jump false positives.
    grace_bps: 0.55
    peak_slack_bps: 1.35

    # legacy (kept for old configs; no longer used by default)
    base_threshold_bps: 8.0
    potion_allowance_bps_per_amp: 1.2
    ignore_after_velocity_ms: 1200
    vl_add: 1.0

  fly:
    enabled: true
    min_air_ticks: 14
    max_abs_y_delta_per_tick: 0.02
    vl_add: 1.5

  reach:
    enabled: true
    # Slightly tighter baseline, still keeps ping compensation.
    base_blocks: 3.15
    ping_comp_blocks_per_ms: 0.0015
    ping_comp_cap_blocks: 0.30
    vl_add: 2.0
    cancel_on_flag: false
    # Rewind target position by latency to reduce false positives on high ping.
    rewind_enabled: true
    rewind_max_ms: 180
    rewind_history_window_ms: 1200
    # When reach and aura flag together, increase certainty.
    solo_weight: 0.90
    combo_weight: 1.20

  killaura:
    enabled: true
    max_angle_deg: 65.0
    switch_window_ms: 250
    vl_add: 1.5
    cancel_on_flag: false
    # When aura and reach flag together, increase certainty.
    solo_weight: 0.90
    combo_weight: 1.20
    check_line_of_sight: true
    # If true and line-of-sight is blocked, set the outgoing damage to 0.
    nullify_damage_on_blocked: true
    # "Annoy" damage dealt to the attacker when flagged (2.0 = 1 heart).
    annoy_damage: 2.0

    # Head-rotation smoothness check (aim-assist style):
    smooth_rotation:
      enabled: true
      window_ms: 1400
      min_samples: 5
      max_yaw_stddev_deg: 0.90
      max_pitch_stddev_deg: 0.70
      min_avg_yaw_delta_deg: 1.80
      min_avg_pitch_delta_deg: 0.25
      vl_add: 1.0

      # GCD-like fixed-step rotation pattern (common in some aim-assist logic)
      gcd:
        enabled: true
        min_samples: 7
        min_step_deg: 0.06
        max_norm_remainder: 0.12
        vl_add: 0.8

      # Very low rotation "jerk" while still moving aim can indicate assisted smoothing.
      jerk:
        enabled: true
        min_samples: 6
        max_avg_yaw_jerk_deg: 0.45
        max_avg_pitch_jerk_deg: 0.30
        min_avg_yaw_delta_deg: 2.00
        min_avg_pitch_delta_deg: 0.30
        vl_add: 0.8

  autoclicker:
    enabled: true
    window_ms: 1000
    min_cps: 12
    instant_cps: 14
    max_stddev_ms: 6.0
    instant_max_stddev_ms: 3.5
    vl_add: 1.2
    vl_add_instant: 3.0
    # Mining (left-click block) creates very stable/high-rate arm swings on many clients.
    # Ignore arm swings shortly after block-damage to avoid false AutoClicker flags.
    ignore_digging: true
    dig_ignore_ms: 350

  scaffold:
    enabled: true
    window_ms: 1200
    min_places: 6
    min_pitch_deg: 75.0
    max_yaw_stddev_deg: 1.5
    max_pitch_stddev_deg: 1.2
    snap_yaw_deg: 35.0
    snap_pitch_deg: 25.0
    max_horizontal_dist_blocks: 1.6
    max_vertical_offset_blocks: 2.0
    vl_add: 2.0
    cancel_on_flag: true
    # "Annoy" punishment: break the placed block immediately when flagged.
    break_last_block: true
    # "Annoy" damage dealt to the player when flagged (2.0 = 1 heart).
    annoy_damage: 2.0

    # Grim-inspired lightweight prediction constraints:
    # reject placements that are too far from eye ray / too off-angle, with a buffer.
    prediction:
      enabled: true
      max_reach_blocks: 4.8
      max_look_angle_deg: 82.0
      buffer_min: 2.0
      buffer_decay: 0.20

  xray:
    enabled: true
    # Only count underground mining below this Y as xray signal.
    max_y: 48
    # Sliding window for ratio statistics.
    window_ms: 300000
    # Need enough mining samples before ratio can flag.
    min_underground_breaks: 45
    min_hidden_ores: 12
    # hidden_ores / underground_breaks ratio threshold.
    max_hidden_ore_ratio: 0.28
    # Extra burst detector for diamond ore.
    diamond_window_ms: 60000
    max_diamond_ore_per_window: 5
    vl_add: 2.5

    # Relax false positives around tool behavior and custom worlds.
    ignore_silk_touch: true
    relax_on_fortune: true
    exempt_worlds: []

    # World-environment overrides (NORMAL/NETHER/THE_END)
    worlds:
      normal:
        max_y: 48
        max_hidden_ore_ratio: 0.28
        max_diamond_ore_per_window: 5
      nether:
        max_y: 48
        # Nether ore distribution differs; keep this looser.
        max_hidden_ore_ratio: 0.40
        max_diamond_ore_per_window: 7
      end:
        max_y: 48
        max_hidden_ore_ratio: 0.28
        max_diamond_ore_per_window: 5

    # Path anomaly detector: hidden ores found too far apart in short time.
    path:
      enabled: true
      window_ms: 120000
      min_hidden_ores: 6
      min_avg_step_distance: 5.5
      vl_add: 1.5

  # Guard for suspicious sudden "all VL becomes zero" resets.
  vl_reset_guard:
    enabled: true
    # Must have at least this total VL before reset-to-zero is considered suspicious.
    min_previous_total_vl: 8.0
    # Previous high VL and current zero must occur within this time window.
    max_drop_window_ms: 5000
    # Avoid repeated punishment spam.
    cooldown_ms: 15000

  noslow:
    enabled: true
    detect_sword: true
    detect_food: true
    detect_potion: true
    sample_window_ms: 900
    min_samples: 4
    min_move_ms: 25
    max_move_ms: 220
    # Grim-like: predict no-item movement first, then apply use-item multipliers.
    sword_use_mult: 0.35
    food_use_mult: 0.20
    potion_use_mult: 0.20
    # Offset tolerance above predicted use-item speed.
    base_offset_bps: 0.20
    peak_offset_bps: 0.38
    # Per-item buffer (continuous offset required)
    sword_buffer_min: 2.0
    food_buffer_min: 1.5
    potion_buffer_min: 1.5
    vl_add: 1.4

  velocity:
    enabled: true
    max_pending_after_hit_ms: 250
    sample_window_ms: 650
    eval_delay_ms: 220
    min_samples: 3
    min_expected_horizontal: 0.10
    min_expected_vertical: 0.08
    # moved / expected ratio below this value is suspicious
    min_take_ratio: 0.20
    min_take_vertical_ratio: 0.20
    vl_add: 2.0
    cancel_on_flag: false

  timer:
    enabled: true
    window_ms: 1500
    min_samples: 14
    # If average move dt is consistently lower than this, timer may be active.
    min_move_dt_ms: 45
    max_low_dt_ratio: 0.45
    min_horiz_per_sample: 0.03
    buffer_min: 2.0
    buffer_decay: 0.20
    vl_add: 1.2
    cancel_on_flag: false

  invmove:
    enabled: true
    ignore_after_velocity_ms: 1200
    min_move_dt_ms: 25
    max_move_dt_ms: 250
    min_move_dist: 0.05
    buffer_min: 2.0
    buffer_decay: 0.20
    vl_add: 1.6
    cancel_on_flag: true

  badpackets:
    enabled: true
    max_abs_coord: 30000000.0
    invalid_pitch_limit: 90.0
    invalid_pitch_vl_add: 3.0
    snap_window_ms: 120
    snap_yaw_deg: 220.0
    snap_pitch_deg: 120.0
    snap_buffer_min: 2.0
    snap_buffer_decay: 0.25
    snap_vl_add: 1.2
    cancel_on_flag: true


movement_sim:
  enabled: true
  # Converts Attribute.GENERIC_MOVEMENT_SPEED (default 0.1) to blocks/second walking speed (~4.317 bps)
  speed_attr_to_bps: 43.17
  sprint_mult: 1.30
  sneak_mult: 0.30
  air_mult: 1.08
  head_hit_air_mult: 1.15
  speed_potion_per_level: 0.20
  special_env_loose_mult: 1.35
  base_slack_bps: 0.75
  peak_slack_bps: 1.25
  sample_window_ms: 550
  min_samples: 6
  min_dt_ms: 20
  max_dt_ms: 220
  # Grim-like item-use slowdown factor (vanilla hard slow is ~0.2, we keep safer 0.35).
  use_item_mult: 0.35
  violation_add: 1.0
  peak_violation_add: 2.5

  # If player exceeds simulated range, pull them back to simulated position.
  setback_to_simulated:
    enabled: true
    extra_slack_bps: 0.20


# Setback tuning ("sticky" teleport) to fight fast fly/blink drift.
setback:
  # After a setback, block movement for N ticks (rotation still allowed).
  freeze_ticks: 10
  # Repeat teleport to last-safe for a few ticks to override client-side prediction.
  repeat_teleports: 3
  # Minimum time between two full setbacks to avoid spam.
  min_interval_ms: 150


debug_chat_default: true

experimental:
  shadow_mode:
    enabled: false
  evidence:
    max_entries_per_player: 20

blink:
  enabled: true
  max_teleport_distance: 20.0
  punish_damage: 2.0
  vl_add: 2.0
  ignore_after_velocity_ms: 1200

nofall:
  enabled: true
  window_ms: 300
  # If true, applies Feather Falling reduction (12% per level). Otherwise, we call player.damage(raw) and let vanilla handle armor/enchant.
  use_feather_falling_formula: false
  debug: false
